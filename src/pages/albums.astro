---
import Layout from '@/layouts/Layout.astro';
import AlbumCard from '@/components/AlbumCard.astro';
import { dummyAlbums, getAllCategories } from '@/lib/dummy-data';

const albums = dummyAlbums;
const categories = getAllCategories();
---

<Layout title="Albums">
  <section class="albums-page">
    <div class="container">
      <header class="page-header">
        <p class="subtle-text">Collections</p>
        <h1 class="display-heading">Albums</h1>
        <p class="page-intro">Browse through curated collections organised by theme, location, and project.</p>
      </header>

      <div class="albums-filters">
        <button class="filter-btn active" data-filter="all">All</button>
        {categories.map(category => (
          <button class="filter-btn" data-filter={category.toLowerCase()}>{category}</button>
        ))}
      </div>

      <div class="albums-grid" id="albums-grid">
        {albums.map(album => (
          <div class="album-wrapper" data-category={album.category.toLowerCase()}>
            <AlbumCard album={album} />
          </div>
        ))}
      </div>
    </div>
  </section>
</Layout>

<style>
  .albums-page { padding: 10rem 0 6rem; }
  .page-header { text-align: center; max-width: 700px; margin: 0 auto 4rem; }
  .page-header .subtle-text { margin-bottom: 0.5rem; }
  .page-intro { font-size: 1.125rem; color: #666; margin-top: 1.5rem; line-height: 1.7; }
  .albums-filters { display: flex; justify-content: center; gap: 0.5rem; margin-bottom: 3rem; flex-wrap: wrap; }
  .filter-btn { padding: 0.625rem 1.25rem; font-size: 0.8125rem; font-weight: 500; letter-spacing: 0.05em; text-transform: uppercase; background: transparent; border: 1px solid #ddd; cursor: pointer; transition: all 0.2s; }
  .filter-btn:hover, .filter-btn.active { background: #1a1a1a; color: #fff; border-color: #1a1a1a; }
  .albums-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 2rem; }
  @media (max-width: 1024px) { .albums-grid { grid-template-columns: repeat(2, 1fr); } }
  @media (max-width: 640px) { .albums-page { padding: 8rem 0 4rem; } .albums-grid { grid-template-columns: 1fr; } }
</style>

<script>
  const filterBtns = document.querySelectorAll('.filter-btn');
  const albumWrappers = document.querySelectorAll('.album-wrapper');

  filterBtns.forEach(btn => {
    btn.addEventListener('click', () => {
      filterBtns.forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      const filter = btn.dataset.filter;
      albumWrappers.forEach(wrapper => {
        if (filter === 'all' || wrapper.dataset.category === filter) {
          (wrapper as HTMLElement).style.display = '';
        } else {
          (wrapper as HTMLElement).style.display = 'none';
        }
      });
    });
  });
</script>
